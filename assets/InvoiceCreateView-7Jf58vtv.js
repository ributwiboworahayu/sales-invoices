import{r as u,s as V,b as O,d as T,c as i,a as t,f as A,w as $,g as M,v as z,x as R,F as j,e as D,y as F,m as I,h as p,i as h,j as v,o as c,q as H,t as U,z as W}from"./index-DoB_7w30.js";const P={class:"container d-flex justify-content-center align-items-center mt-2"},Y={class:"card col-sm mx-2 my-2"},G={class:"mx-2 mt-2"},J=t("i",{class:"bi bi-arrow-left"},null,-1),K={class:"card-body mx-4"},Q=t("div",{class:"mb-3"},[t("h5",{class:"card-title my-2"},"Add Sales Order")],-1),X=t("hr",{class:"hr hr-blurry"},null,-1),Z={key:0,class:"d-flex justify-content-center align-items-center"},ee=t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),te=[ee],se={key:1},oe=I('<div class="mb-3 col-6"><label for="order-type" class="form-label">Type</label><select class="form-select" id="order-type" required><option value="SI">Sales Invoice</option><option selected value="SO">Sales Order</option></select></div>',1),ne={class:"mb-3"},le=t("label",{for:"live-search-select",class:"form-label"},"Select Customer",-1),ae={class:"position-relative"},re={key:0,class:"dropdown-menu show",style:{width:"100%","max-height":"200px","overflow-y":"auto"}},ie=["onClick"],ce=I('<div class="mb-3"><label for="sales-person" class="form-label">Sales Person</label><input type="text" class="form-control" id="sales-person" required></div><div class="mb-3 col-6"><label for="so-date" class="form-label">Sales Order Date</label><input type="date" class="form-control" id="so-date" required></div>',2),de={class:"mb-3"},me=t("label",{for:"warehouse",class:"form-label"},"Warehouse",-1),ue={class:"row g-3"},pe=t("label",{for:"inputItem",class:"form-label"},"Item Name",-1),he={class:"col-7 mb-3 input-item-block"},ve=t("div",{class:"col-2 mb-3 input-item-block-number"},[t("input",{type:"number",class:"form-control",id:"inputItem",placeholder:"Item",min:"1",value:"1"})],-1),be=t("i",{class:"bi bi-plus"},null,-1),fe=[be],_e=t("i",{class:"bi bi-dash"},null,-1),ye=[_e],Ie=I('<div class="mb-3 col-6"><label for="terms" class="form-label">Terms</label><input type="number" class="form-control" id="terms" required></div><div class="mb-3 col-6"><label for="return" class="form-label">Return</label><select class="form-select" id="return" required><option value="1">Yes</option><option selected value="0">No</option></select></div><div class="mb-3 col-6"><label for="discount" class="form-label">Discount</label><input type="number" class="form-control" id="discount" value="0" min="0"></div><div class="mb-3 col-6"><label for="status" class="form-label">Status</label><select class="form-select" id="status" required><option value="1" selected>Wait</option><option value="2">Approved</option><option value="3">Rejected</option></select></div><div class="mb-3"><label for="remarks" class="form-label">Remarks (optional)</label><textarea class="form-control" id="remarks" rows="3"></textarea></div><button type="submit" class="btn btn-primary">Submit</button>',6),Ee={__name:"InvoiceCreateView",setup(ge){const d=u(""),b=u([]),g=u(null),f=u(!1),_=u(!1),B=async()=>{try{const s=await p.get(`${h}customers`,{headers:{Authorization:"Bearer "+v.get("token")}});b.value=s.data.data}catch(s){console.error("Error fetching options:",s)}},E=V(()=>d.value?b.value.filter(s=>s.name.toLowerCase().includes(d.value.toLowerCase())):b.value),m=s=>{const o=document.getElementById(s);o.innerHTML="";const n=document.createElement("option");n.text="Choose...",o.appendChild(n);const e=document.getElementById("warehouse").value;p.get(`${h}warehouses/${e}/product`,{headers:{Authorization:"Bearer "+v.get("token")}}).then(l=>{l.data.data.forEach(a=>{const r=document.createElement("option");r.value=a.id,r.text=a.name,s==="inputItem2"&&document.getElementById("inputItem").value==a.id&&(r.disabled=!0),o.appendChild(r)})}).catch(l=>{console.error("Error fetching products:",l)})},k=()=>{const s=document.getElementById("warehouse");p.get(`${h}warehouses`,{headers:{Authorization:"Bearer "+v.get("token")}}).then(o=>{o.data.data.forEach(n=>{n.id===1&&(s.value=n.name);const e=document.createElement("option");e.value=n.name,e.text=n.address,s.appendChild(e)}),m("inputItem")}).catch(o=>{console.error("Error fetching warehouses:",o)})};O(()=>{B(),k()});const w=s=>{g.value=s.id,d.value=s.name,f.value=!1},C=()=>{m("inputItem"),document.getElementById("inputItem2")!==null&&m("inputItem2")},x=()=>{document.getElementById("inputItem2")!==null&&m("inputItem2")},N=()=>{const s=document.getElementsByClassName("input-item-block"),o=s[s.length-1];o.parentNode.removeChild(o);const n=document.getElementsByClassName("input-item-block-number"),e=n[n.length-1];e.parentNode.removeChild(e);const l=document.getElementById("add-items");l.hidden=!1;const a=document.getElementById("remove-items");a.hidden=!0},S=()=>{if(document.getElementById("inputItem").value==="Choose...")return;const o=document.getElementById("add-items");o.hidden=!0;const n=document.getElementById("remove-items");n.hidden=!1;const e=document.getElementsByClassName("input-item-block"),l=e[e.length-1],a=document.createElement("div");a.classList.add("col-7","mb-3","input-item-block"),l.children[0].value,a.innerHTML=`
    <select class="form-select" id="inputItem2" required>
      <!-- dinamically add options here -->
    </select>`,l.parentNode.appendChild(a),m("inputItem2");const r=document.getElementsByClassName("input-item-block-number"),L=r[r.length-1],y=document.createElement("div");y.classList.add("col-2","mb-3","input-item-block-number"),y.innerHTML=`
    <input type="number" class="form-control" id="inputItem" placeholder="Item" min="1" value="1">`,L.parentNode.appendChild(y)},q=async()=>{_.value=!0;const s=[],o=document.getElementsByClassName("input-item-block"),n=document.getElementsByClassName("input-item-block-number");for(let e=0;e<o.length;e++)s.push({item_id:o[e].children[0].value,quantity:n[e].children[0].value});try{const e=await p.post(`${h}invoices`,{order_type:document.getElementById("order-type").value,customer_id:g.value,sales_person:document.getElementById("sales-person").value,invoice_date:document.getElementById("so-date").value,warehouse_name:document.getElementById("warehouse").value,items:s,terms:document.getElementById("terms").value,is_return:document.getElementById("return").value,discount:document.getElementById("discount").value,remarks:document.getElementById("remarks").value,status:document.getElementById("status").value},{headers:{Authorization:"Bearer "+v.get("token")}});e.data.status==="success"?await W.push("/invoices"):alert(e.data.message)}catch(e){console.error("Error creating sales order:",e),alert("Something went wrong"+e)}finally{_.value=!1}};return(s,o)=>{const n=T("RouterLink");return c(),i("div",null,[t("div",P,[t("div",Y,[t("div",G,[A(n,{class:"btn btn-outline-secondary",to:"/invoices"},{default:$(()=>[J,H(" Back ")]),_:1})]),t("div",K,[Q,X,t("form",{onSubmit:M(q,["prevent"])},[_.value?(c(),i("div",Z,te)):(c(),i("div",se,[oe,t("div",ne,[le,t("div",ae,[z(t("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>d.value=e),onFocus:o[1]||(o[1]=e=>f.value=!0),class:"form-control",placeholder:"Search for a customer",style:{width:"100%"},required:""},null,544),[[R,d.value]]),f.value?(c(),i("div",re,[(c(!0),i(j,null,D(E.value,e=>(c(),i("button",{key:e.id,class:"dropdown-item",onClick:l=>w(e)},U(e.name),9,ie))),128))])):F("",!0)])]),ce,t("div",de,[me,t("select",{class:"form-select",id:"warehouse",required:"",onChange:C},null,32)]),t("div",ue,[pe,t("div",he,[t("select",{class:"form-select",id:"inputItem",required:"",onChange:x},null,32)]),ve,t("div",{class:"col-2 add-items-block"},[t("button",{type:"button",class:"btn btn-secondary mb-3",onClick:S,id:"add-items"},fe),t("button",{type:"button",class:"btn btn-secondary mb-3",onClick:N,id:"remove-items",hidden:"hidden"},ye)])]),Ie]))],32)])])])])}}};export{Ee as default};
